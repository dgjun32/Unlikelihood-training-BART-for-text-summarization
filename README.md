# Sequence-level unlikelihood fine-tuning KoBART

## 1. Backgroud
Current Korean text abstractive generation models suffer from ```text degeneration```, which includes text repetition issue.

Applying advanced <b>stochastic decoding strategies</b> such as ```top-k sampling``` and ```nucleaus sampling``` can mitigate text repetition issue with open-ended language generation tasks. 

Recent research([Cho et al.2019](https://github.com/facebookresearch/unlikelihood_training)) suggests unlikelihood training to resolve text degeneration issue.

I applied unlikelihood training scheme to finetune pretrained ```KoBART```(Korean BART).

## 2. Data Preparation

1. Set directory : ```$cd data/```
2. Download ```.json```file to current dir from the <b>AI hub</b> [link](https://aihub.or.kr/aidata/8054)

## 3. Training

1. Set directory : ```$cd code/```
2. Training + Validation : ```$python main.py```

## 4. Demo
News Article 1
```
한국수력원자력(사장 정재훈, 이하 한수원)이 지난 6일 경주 황룡원에서 발전소 상주협력사 및 원전건설 주설비 시공사 등 20개 협력사,
39 명이 참석한 가운데 '한수원 협력사 안전문화 협의회'를 개최했다. 협의회는 최근 이슈가 되고 있는 협력사 직원들의 산업안전사고를         
예방하고, 안전문화에 관한 한수원의 프로그램 등을 전파함으로써 협력사의 안전의식 수준을 개선하기 위해 개최됐다. 협의회에서는 세한대    
김천용 교수의 안전문화 특강이 있었고, 협력사 대표들과의 안전다짐 서약식을 통해 원자력 안전에 대한 공동체 의식을 높이고 소통과 협업을  
통해 지속적인 안전문화 향상에 노력할 것을 다짐했다. 이어 한수원은 협력사들의 애로사항을 청취하며 현장 최일선까지 정착될 수 있는     
안전문화 체계 구축을 약속했고, 안전이 보장된 양질의 일자리 창출을 위한 지역경제 지원 방안에 대해서도 열띤 토론을 펼쳤다. 이재동 한수원
품질안전본부장은 "한수원은 앞으로도 협력사의 안전의식 제고는 물론, 안전에 대한 상생협력을 더욱 강화해 안전사고 예방에 힘쓸 것"이라며,
"안전 최우선 일터 구현'이라는 사회적 가치를 실현하기 위해 끊임없이 노력하겠다"고 말했다.     
```

Abstractive Summarization 1
```
한국수력원자력이 지난 6일 경주 황룡원에서 20개 협력사, 39명이 참석한 가운데 한수원-협력사 안전문화 협의회를 개최하여 세한대
김천용 교수의 안전문화 특강과 안전다짐 서약식을 통해 안전문화 체계 구축을 약속하고 안전이 보장된 양질의 일자리 창출을 위한 
지역경제 지원 방안에 대해서도 열띤 토론을 벌였다.                                                           |
```

News Article 2
```
무소속 이용호(남원.임실.순창)의원은 4일 타워크레인의 제작기준을 명확히 하는 ‘건설기계관리법 일부개정법률안’을 대표발의 했다고 밝혔다.
이 개정안은 타워크레인을 한국산업표준에 따라 제작하도록 하고, 고도로 선회하는 타워크레인의 경우에는 운전석 설치를 의무화 하도록 했다.
현행법은 타워크레인의 규모나 양중 무게 등에 대한 제작 기준이 전혀 없는 상태이며, 타워크레인의 규모와 상관없이 유인·무인의 기능을 손쉽게 적용해 이용할 
수 있는 실정이다.
이에 이 의원은 “현재 타워크레인은 불법개조나 제원표 위조 외에도 중국산 짝퉁 생산 및 수입, 저질?
저가 장비 도입 등 직면한 문제점이 너무 많다”면서, “가장 시급한 것은 ‘얼마나 제대로 만드느냐’는 제작 기준을 명확히 하는 것”이라고 강조했다.
이 의원은 또 “타워크레인 제도개선에 대해서는 지난 3월부터 국토부에 노사정 TF를 만드는 등 대화를 지속적으로 할 수 있는 협의체를 만들어 운영하길 
주문해왔다”면서 “이것을 갈등을 외부로 표출시키는 행위로 규정하고 TF를 만들지 않겠다고 고집한 국토부의 안일한 자세가 타워크레인 동시파업과 같은 엄중한 
사태를 촉발시킨 것”이라고 꼬집었다.
한편, 이 의원은 2018년 국정감사에서 불법개조 된 타워크레인의 문제점과 현장에서 이루어지는 불법 백태에 대해 심도 있게 지적한 이후 타워크레인 안전을 
위한 국회 정책토론회를 개최 하는 등 사회 안전을 위한 제도 개선에 힘을 쏟고 있다.
```

Abstractive Summarization 2
```
무소속 이용호의원은 타워크레인의 제작기준을 명확히 하는 ‘건설기계관리법 일부개정법률안’을 대표발의 했으며 타워크레인 제도개선에 대해서는 지난 3월부터
국토부에 노사정 TF를 만드는 등 대화를 지속적으로 할 수 있는 협의체를 만들어 운영하길 주문해왔다고 밝혔다.
```

News Article 3
```
고속도로 경부선 안성휴게소 양방향과 영동선 여주휴게소 강릉방향 등 세 곳의 휴게소에 수소충전소가 개장했다.
전국 고속도로 휴게소 중에서 처음 문을 연 수소충전소다.
올해 휴게소 충전소 다섯 곳이 추가 개장할 예정이다.
정부는 2022년까지 전국에 310개의 수소충전소를 설치할 계획이다.
국토교통부와 한국도로공사는 12일 경부고속도로 안성휴게소 등 세 곳의 수소충전소를 구축하고 정식 개장했다.
고속도로 수소충전소는 이용자 편의를 위해 연중무휴로 오전 8시부터 밤 10시까지 운영된다.
요금은 고속도로 수소충전소 전체가 동일하게 ㎏당 8000원(부가세 포함)이다.
이는 수소공급업체에서 공급받는 가격 그대로 마진 없이 판매하는 것이라고 국토부는 설명했다.
현재 나와 있는 차량 기준으로 수소 1㎏은 약 100㎞를 달릴 수 있는 양이다.
국토부와 도공은 올 상반기 중 고속도로 수소충전소 5기를 추가 개장해 총 8기의 충전소를 운영하고, 올해 안에 수소충전소 10기를 추가 착공할 예정이다.
추가로 개장하는 다섯 곳의 충전소는 경부선 언양(서울방향), 남해선 함안(부산방향), 호남선 백양사(천안방향), 중부선 하남드림, 중부내륙선 성주(양평방향) 
등이다.
국토부는 고속도로 휴게소는 물론 복합환승센터, 버스 차고지 등 전국 주요 교통거점에 2022년까지 총 310개의 수소충전소를 구축해 수소차 전국 보급 기반을 
확보할 방침이다.
도심 운행이 많은 노선버스는 우선 수소버스로 교체하고, 차고지 내 충전소 건설과 친환경 연료 보조금을 패키지로 지원해 수소버스 도입을 장려할 예정이다.
이와 함께 교통 분야뿐만 아니라 공동주택, 빌딩, 차량 등 도시의 필수 구성요소의 에너지원을 수소로 전환하는 '수소 시범도시'도 올해 세 곳을 선정해 조성할 
방침이다.
```

Abstractive Summarization 3
```
국토교통부와 한국도로공사는 12일 경부고속도로 안성휴게소 등 세 곳의 수소충전소를 구축하고 정식 개장하였고 올해 휴게소 다섯 곳이 추가 개장할 예정이며 
국토부와 도공은 올해 안에 수소 충전소 10기를 추가 착공할 계획이다.
```

## 5. Result

Evaluated by Dacon Gas text summarization competition dataset

| Rouge 1 | Rouge 2 | Rouge L |
|:---|:---|:---|
| 0.50751055 | 0.33009406 | 0.40286391 |